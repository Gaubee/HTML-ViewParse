<!DOCTYPE html>

<head>
    <title>app - jSouper</title>
    <script type="text/javascript" src="../build/jSouper.debug.js">
    </script>

</head>

<body>
    <xmp type="template" name="myView">
        {{title}}:{{name}}:{{c.a}}
        <hr>
    </xmp>
    <xmp type="template" name="layout_test">
        ---------
        <br>{{#layout 'myView','$This'}} ---------
        <br>
    </xmp>
    <xmp type="template" name="global">
        <h2>my name is:{{$Js.myName}}</h2>
    </xmp>
</body>

</html>
<script type="text/javascript">
jSouper.ready(function(argument) {

    m = new Model;
    console.group("渐进式创建");
    c = m.buildModelByKey("c");
    a = m.buildModelByKey("c.a");
    console.log(Model.$router(a, "$Parent").model == c);
    console.log(Model.$router(a, "$Parent.$Parent").model == m);
    console.log(Model.$router(a, "$Top").model == m);
    console.groupEnd("渐进式创建");

    console.group("截断式创建");
    b = m.buildModelByKey("d.b");
    d = m.buildModelByKey("d");
    console.log(Model.$router(b, "$Parent").model == d);
    console.log(Model.$router(b, "$Parent.$Parent").model == m);
    console.log(Model.$router(b, "$Top").model == m);
    console.groupEnd("截断式创建");

    console.group("测试赋值取值");
    m.set("c", {
        a: "test String"
    });
    console.log(m.get("c.a"), ":", c.get("a") === a.get());
    a.set("test String 2");
    console.log(m.get("c.a"), ":", c.get("a") === a.get());
    console.groupEnd("测试赋值取值");

    console.group("生成ViewModel");
    vm = jSouper.modules["myView"]({
        name: "hhh",
        title: "?????"
    });
    console.log(vm.get("name"), ":", vm.get("name") === "hhh");
    vm.append(document.body)
    console.groupEnd("生成ViewModel");

    console.group("vm注入model");
    vm2 = jSouper.modules["myView"](m);
    m.set("name", "zzzz")
    console.log(vm2.get("name"), ":", vm2.get("name") === "zzzz");
    vm2.append(document.body)
    console.groupEnd("生成ViewModel");

    console.group("测试layout")
    vm_layout = jSouper.modules["layout_test"]();
    vm_layout.append(document.body);
    vm.model.shelter(vm_layout);
    console.log("model绑定是否正确", vm_layout.getModel() === vm.getModel());
    console.groupEnd("测试layout")

    console.group("测试$JS")
    window.myName = "Gaubee"
    vm_global = jSouper.modules["global"]();
    vm_global.append(document.body);
    vm_global.model.follow(m);
    m.get("$Js.myName");
    console.log("全局绑定是否正确", vm_global.get("$Js.myName") === "Gaubee");
    console.groupEnd("测试$JS")

});
</script>
