<!DOCTYPE html>
<html>

<head>
    <title>HTML-ViewParse</title>
    <script type="text/javascript" src="../build/HTML-ViewParse.debug.js"></script>
    <style>
    html{
    	font-weight: bold;
    }
    </style>
</head>

<body>

</body>

<script type="text/template" name="data">
<div attr-style="color:{{color}}"> self: {{color}}</div>
<div attr-style="color:{{$PARENT.color}}">parent:{{$PARENT.color}}</div>
<div attr-style="color:{{$TOP.color}}"> top: {{$TOP.color}}</div>
<div attr-style="color:{{$THIS.color}}">this:{{$THIS.color}}</div>
<hr>
</script>


</html>

<script type="text/javascript">
ViewParser.ready(function() {

    data = ViewParser.modules["data"];

    //main data-tree-1
    vModel1 = data({
        color: "#000",
        child:{
        	color:"#666",
        	child:{
        		color:"#aaa"
        	}
        }
    }).append(document.body);

    //child
    childVM = data({
        color: "blue"//un useful
    }).append(document.body);

    vModel1.dataManager.subset(childVM, "child");

    //child -> child
    cchildVM = data({
        color: "green"//un useful
    }).append(document.body);

    childVM.dataManager.subset(cchildVM, "child");

    //child -> child -> parent -> child
    anonymousVM = data().append(document.body)

    cchildVM.dataManager.subset(anonymousVM, "$PARENT.child");

//--------------------------------------------------
    //main data-tree-2
    vModel2 = data({
    	color:"#00f",
    	child:{
    		color:"#33f"
    	}
    }).append(document.body);

    //child
    childVM2 = data().append(document.body);
    vModel2.dataManager.subset(childVM2,"child");

 	setTimeout(function() {
 		//childVM -> childVM2
 		debugger
    	childVM.dataManager.collect(childVM2);
    }, 1000);

 	setTimeout(function() {
    	childVM.set("color","green");
    }, 1500);

    setTimeout(function(argument) {
        anonymousVM.set("$TOP.color", "red")
    }, 2000);
});
</script>
